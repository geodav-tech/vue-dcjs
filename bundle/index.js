/*!
 * vue-dcjs v0.1.1
 * (c) shawn@geodav.tech
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("dc"),e=require("d3"),i=require("crossfilter2"),r=require("vue-runtime-helpers/dist/normalize-component.mjs");function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,Object.freeze(e)}var s=n(t),a=n(e),c=o(i),u=o(r);function h(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=l(t);if(e){var o=l(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return v(this,i)}}var y=function(i){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(a,t.CapMixin(t.ColorMixin(t.MarginMixin)));var r,o,n,s=m(a);function a(t,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),d(f(r=s.call(this)),"_g",void 0),d(f(r),"_scale",void 0),d(f(r),"_elastic",void 0),d(f(r),"_type","axisBottom"),d(f(r),"_theAxis",e.axisBottom()),d(f(r),"_axisData",void 0),d(f(r),"validAxisTypes",["axisBottom","axisTop","axisLeft","axisRight"]),d(f(r),"axisCap",void 0),v(r,r.anchor(t,i))}return r=a,(o=[{key:"calculateAxisScale",value:function(){var t=this;if(!this._scale||!this._elastic){var i=e.extent(this._axisData,(function(e,i){return t.cappedValueAccessor(e,i)}));i[0]>0&&(i[0]=0),i[1]<0&&(i[1]=0),this._scale=e.scaleLinear().domain(i).range([0,"axisBottom"===this._type||"axisTop"===this._type?this.effectiveWidth():this.effectiveHeight()])}this._theAxis.scale(this._scale)}},{key:"drawAxis",value:function(){var e=this._g.select("g.axis");this.calculateAxisScale(),e.empty()&&(e=this._g.append("g").attr("class","axis")),t.transition(e,this.transitionDuration(),this.transitionDelay()).call(this._theAxis)}},{key:"_doRender",value:function(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform","translate(".concat(this.margins().left,", ").concat(this.margins().top,")")),this.drawChart(),this}},{key:"type",value:function(t){return arguments.length?(-1!==this.validAxisTypes.indexOf(t)?(this._theAxis=d3[t](),this._type=t):console.error(t+" is not a valid d3 axis type"),this):this._type}},{key:"scale",value:function(t){return arguments.length?(this._scale=t,this):this._scale}},{key:"elastic",value:function(t){return arguments.length?(this._elastic=t,this):this._elastic}},{key:"axis",value:function(){return this._theAxis}},{key:"drawChart",value:function(){this._axisData=this.data(),this.drawAxis()}},{key:"_doRedraw",value:function(){return this.drawChart(),this}}])&&h(r.prototype,o),n&&h(r,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(),g={install:function(t,e){s.AxisChart=y,null!=e&&e.defaultColors&&(s.config.defaultColors=e.defaultColors),t.prototype.$dc=s,t.prototype.$d3=a,t.prototype.$crossfilter=c.default}},x={name:"BaseChartMixin",dimension:null,props:{ndx:{type:Object,required:!0},options:{type:Object}},baseDefaultOptions:{disposeDimension:!0},data:function(){return{chart:null}},mounted:function(){this.drawChart()},methods:{reset:function(){this.chart&&this.chart.filter(null)},drawChart:function(){var t=this.computedOptions,e=t.valueAccessor,i=t.margins,r=t.keyAccessor,o=t.title,n=t.label;e&&this.chart.valueAccessor(accessorFunc(e)),i&&this.chart.margins(i),r&&this.chart.keyAccessor(accessorFunc(r)),o&&this.chart.title(accessorFunc(o)),n&&this.chart.label(accessorFunc(n))}},computed:{computedOptions:function(){return Object.assign({},this.$options.baseDefaultOptions,this.$options.defaultOptions,this.options)}},beforeDestroy:function(){if(this.chart){var t=this.chart.dimension();t&&t.filterAll(),this.$dc.chartRegistry.deregister(this.chart)}this.computedOptions.disposeDimension&&this.$options.dimension&&this.$options.dimension.dispose()}},b=u.default({},void 0,x,void 0,void 0,void 0,!1,void 0,void 0,void 0),O={name:"DimensionMixin",props:{dimensionConstructor:{type:[String,Function]},dimensionIsArray:{type:Boolean,default:!1}},methods:{createDimension:function(){var t=function(t){return t};return"string"==typeof this.dimensionConstructor?t=this.$dc.pluck(this.dimensionConstructor):"function"==typeof this.dimensionConstructor&&(t=this.dimensionConstructor),this.ndx.dimension(t,this.dimensionIsArray)}}};function _(t){return"function"==typeof t?t:function(e){return e[t]}}var C={name:"GroupMixin",props:{reducer:{type:[String,Function,Object]},groupOptions:{type:Object}},methods:{createGroup:function(t){var e=this,i=t.group();if(this.groupOptions&&this.groupOptions.order?"string"==typeof this.groupOptions.order?i.order((function(t){return t[e.groupOptions.order]})):"function"==typeof this.groupOptions.order&&i.order(this.groupOptions.order):this.groupOptions&&this.groupOptions.orderNatural&&i.orderNatural(),"string"==typeof this.reducer||"function"==typeof this.reducer)i.reduceSum(_(this.reducer));else if(this.reducer.add&&this.reducer.remove&&this.reducer.init){var r=this.reducer,o=r.add,n=r.remove,s=r.init;i.reduce(o,n,s)}return this.$emit("group-created",i),i}}},w={name:"DcRowChart",mixins:[b,u.default({},void 0,O,void 0,void 0,void 0,!1,void 0,void 0,void 0),u.default({},void 0,C,void 0,void 0,void 0,!1,void 0,void 0,void 0)],defaultOptions:{elastic:!0,scrollable:!0,minHeight:150,barHeight:20,axisChartheight:50,scrollHeight:"200px"},data:function(){return{axisChart:null}},methods:{drawChart:function(){var t=this,e={top:30,right:30,bottom:30,left:30},i=this.computedOptions,r=i.margins,o=i.elastic,n=i.scrollable,s=i.minHeight,a=i.barHeight,c=i.axisChartHeight,u=i.valueAccessor,h=i.keyAccessor,d=i.labelAccessor;this.$options.dimension=this.createDimension();var l=this.createGroup(this.$options.dimension);if(this.chart=this.$dc.rowChart("#chart-".concat(this._uid)).dimension(this.$options.dimension).group(l),this.$super(b).drawChart(),r||n){var p=n?Object.assign({},e,r,{bottom:-1}):r||e;this.chart.margins(p)}if(o&&this.chart.elasticX(!0),d&&this.chart.label(_(d)),n){this.chart.height(Math.max(s,l.size()*a)),this.chart.transitionDuration(1e3);var f=Object.assign({},e,r,{top:0});this.axisChart=new y("#chart-".concat(this._uid,"-axis")).dimension(this.$options.dimension).group(l).height(c).margins(f),u&&this.axisChart.valueAccessor(_(u)),h&&this.axisChart.keyAccessor(_(h)),o&&this.axisChart.elastic(!0)}this.$emit("pre-render",this.chart),this.$nextTick((function(){t.chart.render(),t.axisChart.render(),t.$nextTick((function(){t.$emit("post-render")}))}))}},computed:{computedStyle:function(){return this.computedOptions.scrollable&&this.computedOptions.scrollHeight?"max-height: ".concat(this.computedOptions.scrollHeight,"; overflow-y: auto;"):""}}},j=u.default({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dc-chart-container"},[e("div",{staticClass:"dc-chart dc-row-chart",style:this.computedStyle,attrs:{id:"chart-"+this._uid}}),this._v(" "),this.computedOptions.scrollable?e("div",{staticClass:"dc-chart dc-axis-chart dc-row-axis-chart",attrs:{id:"chart-"+this._uid+"-axis"}}):this._e()])},staticRenderFns:[]},void 0,w,void 0,!1,void 0,!1,void 0,void 0,void 0),A={install:function(t,e){t.prototype.$super=function(t){var e=this;return new Proxy(t,{get:function(t,i){if(t.methods&&i in t.methods)return t.methods[i].bind(e)}})},t.use(g,e),t.component("dc-row-chart",j)}};exports.VueDc=A;
//# sourceMappingURL=index.js.map
