/*!
 * vue-dcjs v0.1.3
 * (c) 
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("dc"),e=require("d3"),i=require("crossfilter2"),r=require("vue-runtime-helpers/dist/normalize-component.mjs"),n=require("vue-runtime-helpers/dist/inject-style/browser.mjs");function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,Object.freeze(e)}var a=o(t),c=o(e),h=s(i),u=s(r),d=s(n);function l(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=f(t);if(e){var n=f(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return y(this,i)}}var x=function(i){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&v(t,e)}(a,t.CapMixin(t.ColorMixin(t.MarginMixin)));var r,n,s,o=g(a);function a(t,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),p(m(r=o.call(this,t,i)),"_g",void 0),p(m(r),"_scale",void 0),p(m(r),"_elastic",void 0),p(m(r),"_type","axisBottom"),p(m(r),"_theAxis",e.axisBottom()),p(m(r),"_axisData",void 0),p(m(r),"validAxisTypes",["axisBottom","axisTop","axisLeft","axisRight"]),p(m(r),"axisCap",void 0),r.anchor(t,i),r}return r=a,(n=[{key:"calculateAxisScale",value:function(){var t=this;if(!this._scale||this._elastic){var i=e.extent(this._axisData,(function(e,i){return t.cappedValueAccessor(e,i)}));i[0]>0&&(i[0]=0),i[1]<0&&(i[1]=0),this._scale=e.scaleLinear().domain(i).range([0,"axisBottom"===this._type||"axisTop"===this._type?this.effectiveWidth():this.effectiveHeight()])}this._theAxis.scale(this._scale)}},{key:"drawAxis",value:function(){var e=this._g.select("g.axis");this.calculateAxisScale(),e.empty()&&(e=this._g.append("g").attr("class","axis")),t.transition(e,this.transitionDuration(),this.transitionDelay()).call(this._theAxis)}},{key:"_doRender",value:function(){return this.minHeight(1),this.height(50),this.resetSvg(),this._g=this.svg().append("g").attr("transform","translate(".concat(this.margins().left,", ").concat(this.margins().top,")")),this.drawChart(),this}},{key:"type",value:function(t){return arguments.length?(-1!==this.validAxisTypes.indexOf(t)?(this._theAxis=d3[t](),this._type=t):console.error(t+" is not a valid d3 axis type"),this):this._type}},{key:"scale",value:function(t){return arguments.length?(this._scale=t,this):this._scale}},{key:"elastic",value:function(t){return arguments.length?(this._elastic=t,this):this._elastic}},{key:"axis",value:function(){return this._theAxis}},{key:"drawChart",value:function(){this._axisData=this.data(),this.drawAxis()}},{key:"_doRedraw",value:function(){return this.drawChart(),this}}])&&l(r.prototype,n),s&&l(r,s),Object.defineProperty(r,"prototype",{writable:!1}),a}();require("dc/dist/style/dc.min.css"),a.AxisChart=x;var b={install:function(t,e){null!=e&&e.defaultColors&&(a.config.defaultColors=e.defaultColors),t.prototype.$dc=a,t.prototype.$d3=c,t.prototype.$crossfilter=h.default}};function O(t){return"function"==typeof t?t:function(e){return e[t]}}var _={name:"BaseChartMixin",dimension:null,props:{ndx:{type:Object,required:!0},options:{type:Object}},baseDefaultOptions:{disposeDimension:!0},data:function(){return{chart:null}},mounted:function(){this.drawChart()},methods:{reset:function(){this.chart&&this.chart.filter(null)},drawChart:function(){this.createChart(),this.renderChart()},createChart:function(){var t=this.computedOptions,e=t.valueAccessor,i=t.margins,r=t.keyAccessor,n=t.title,s=t.label;e&&this.chart.valueAccessor(O(e)),i&&this.chart.margins(i),r&&this.chart.keyAccessor(O(r)),n&&this.chart.title(O(n)),s&&this.chart.label(O(s))},renderChart:function(){var t=this;return new Promise((function(e){t.$emit("pre-render",t.chart),t.$nextTick((function(){t.render(),t.$nextTick((function(){return t.$emit("post-render"),e()}))}))}))},render:function(){this.chart.render()}},computed:{computedOptions:function(){return Object.assign({},this.$options.baseDefaultOptions,this.$options.defaultOptions,this.options)}},beforeDestroy:function(){if(this.chart){var t=this.chart.dimension();t&&t.filterAll(),this.$dc.chartRegistry.deregister(this.chart)}this.computedOptions.disposeDimension&&this.$options.dimension&&this.$options.dimension.dispose()}},C=u.default({},void 0,_,void 0,void 0,void 0,!1,void 0,void 0,void 0),w={name:"DimensionMixin",props:{dimensionConstructor:{type:[String,Function]},dimensionIsArray:{type:Boolean,default:!1}},methods:{createDimension:function(){var t=function(t){return t};return"string"==typeof this.dimensionConstructor?t=this.$dc.pluck(this.dimensionConstructor):"function"==typeof this.dimensionConstructor&&(t=this.dimensionConstructor),this.ndx.dimension(t,this.dimensionIsArray)}}},$=u.default({},void 0,w,void 0,void 0,void 0,!1,void 0,void 0,void 0),j={name:"GroupMixin",props:{reducer:{type:[String,Function,Object]},groupOptions:{type:Object}},methods:{createGroup:function(t){var e=this,i=t.group();if(this.groupOptions&&this.groupOptions.order?"string"==typeof this.groupOptions.order?i.order((function(t){return t[e.groupOptions.order]})):"function"==typeof this.groupOptions.order&&i.order(this.groupOptions.order):this.groupOptions&&this.groupOptions.orderNatural&&i.orderNatural(),"string"==typeof this.reducer||"function"==typeof this.reducer)i.reduceSum(O(this.reducer));else if(this.reducer.add&&this.reducer.remove&&this.reducer.init){var r=this.reducer,n=r.add,s=r.remove,o=r.init;i.reduce(n,s,o)}return this.$emit("group-created",i),i}}},R=u.default({},void 0,j,void 0,void 0,void 0,!1,void 0,void 0,void 0),A={name:"DcRowChart",mixins:[C,$,R],defaultOptions:{elastic:!0,scrollable:!0,minHeight:150,barHeight:20,axisChartheight:50,scrollHeight:"200px"},data:function(){return{axisChart:null}},methods:{createChart:function(){var t={top:30,right:30,bottom:30,left:30},e=this.computedOptions,i=e.margins,r=e.elastic,n=e.scrollable,s=e.minHeight,o=e.barHeight,a=e.axisChartHeight,c=e.valueAccessor,h=e.keyAccessor;this.$options.dimension=this.createDimension();var u=this.createGroup(this.$options.dimension);if(this.chart=new this.$dc.RowChart("#chart-".concat(this._uid)).dimension(this.$options.dimension).group(u),this.$super(C).createChart(),i||n){var d=n?Object.assign({},t,i,{bottom:-1}):i||t;this.chart.margins(d)}if(r&&this.chart.elasticX(!0),n){this.chart.height(Math.max(s,u.size()*o)),this.chart.transitionDuration(1e3);var l=Object.assign({},t,i,{top:0});this.axisChart=new this.$dc.AxisChart("#chart-".concat(this._uid,"-axis")).dimension(this.$options.dimension).group(u).height(a).margins(l),c&&this.axisChart.valueAccessor(O(c)),h&&this.axisChart.keyAccessor(O(h)),r&&this.axisChart.elastic(!0)}},render:function(){this.$super(C).render(),this.axisChart.render()}},computed:{computedStyle:function(){return this.computedOptions.scrollable&&this.computedOptions.scrollHeight?"max-height: ".concat(this.computedOptions.scrollHeight,"; overflow-y: auto;"):""}}},D=u.default({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dc-chart-container"},[e("div",{staticClass:"dc-chart dc-row-chart",style:this.computedStyle,attrs:{id:"chart-"+this._uid}}),this._v(" "),this.computedOptions.scrollable?e("div",{staticClass:"dc-chart dc-axis-chart dc-row-axis-chart",attrs:{id:"chart-"+this._uid+"-axis"}}):this._e()])},staticRenderFns:[]},void 0,A,void 0,!1,void 0,!1,void 0,void 0,void 0),k={name:"DcPieChart",mixins:[C,$,R],defaultOptions:{minRadius:0,maxRadius:1/0,innerRadius:0,slicesCap:10,othersLabel:"others",useImprovedLabels:!0,labelWrapSeparator:";|;"},methods:{createChart:function(){var t=this;this.$options.dimension=this.createDimension();var e=this.createGroup(this.$options.dimension);this.chart=new this.$dc.PieChart("#chart-".concat(this._uid)).dimension(this.$options.dimension).group(e).externalRadiusPadding(12),this.$super(C).createChart();var i=this.getRadius();this.chart.radius(i),this.chart.width(i),this.chart.height(i);var r=this.computedOptions,n=r.innerRadius,s=r.slicesCap,o=r.othersLabel,a=r.useImprovedLabels;if(s&&this.chart.slicesCap(s),o&&this.chart.othersLabel(o),n){var c="number"==typeof n?n:i*(parseInt(n)||0)/100;this.chart.innerRadius(c)}if(a){var h=function(e){var i=t.$d3,r=t.computedOptions.labelWrapSeparator;e.each((function(){var t=i.select(this),e=t.text().split(r);if(e&&!(e.length<2)){var n=t.attr("transform"),s=parseFloat(n.slice(n.indexOf("translate(")+10,n.indexOf(",")-1)),o=parseFloat(n.slice(n.indexOf(",")+1,n.indexOf(")"))),a=t.text(null).append("tspan").attr("transform","translate(".concat(s,", ").concat(o,")")).attr("x",0).attr("y",0);a.text(e[0]),(a=t.append("tspan").attr("transform","translate(".concat(s,", ").concat(o,")")).attr("x",0).attr("y",14)).text("(".concat(e[1].replace(/[^0-9\-.]/g,""),")"))}}))},u=function(){t.chart.selectAll("text.pie-label").attr("transform",(function(e,i){var r=function(t,e){var i=e.centroid(t);return i.some((function(t){return isNaN(t)}))?[0,0]:i}(e,function(){var e=Math.min(t.chart.width(),t.chart.height())/1.8,i=Math.min(t.chart.radius(),e);return t.$d3.arc().outerRadius(i).innerRadius(t.chart.innerRadius())}(t.chart)),n=(i+1)/6+.3;return r[1]<0&&(n=1),"translate(".concat(r[0],", ").concat(r[1]*n,")")})),t.chart.selectAll(".pie-label-group text.pie-label").transition().call(h)};this.chart.on("renderlet",(function(e){var i=t.getRadius();t.chart.radius()!==i&&(t.chart.height(i),t.chart.width(i),t.chart.redraw()),u()})),this.chart.on("pretransition",u)}},renderChart:function(){var t=this;return new Promise((function(e){t.$super(C).renderChart().then((function(){t.$nextTick((function(){return t.computedOptions.useImprovedLabels&&t.chart.redraw(),e()}))}))}))},getRadius:function(){var t=document.querySelector("#chart-".concat(this._uid));if(!t)return 0;var e=t.clientWidth,i=this.computedOptions;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Math.max(e,Math.min(t,i))}(e,i.minRadius,i.maxRadius)}}},P=function(t){t&&t("data-v-6b660a74_0",{source:".dc-chart.dc-pie-chart .pie-slice:hover{fill-opacity:.8}",map:void 0,media:void 0})},M=u.default({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dc-chart-container"},[e("div",{staticClass:"dc-chart dc-pie-chart",attrs:{id:"chart-"+this._uid}})])},staticRenderFns:[]},P,k,void 0,!1,void 0,!1,d.default,void 0,void 0),S={install:function(t,e){t.prototype.$super=function(t){var e=this;return new Proxy(t,{get:function(t,i){if(t.methods&&i in t.methods)return t.methods[i].bind(e)}})},t.use(b,e),t.component("dc-row-chart",D),t.component("dc-pie-chart",M)}};exports.dc=a,exports.d3=c,Object.defineProperty(exports,"crossfilter",{enumerable:!0,get:function(){return h.default}}),exports.VueDc=S;
//# sourceMappingURL=index.js.map
